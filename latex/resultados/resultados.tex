% Intended LaTeX compiler: pdflatex
\documentclass[letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{lmodern} % Ensures we have the right font
\usepackage{listings} % Syntax highlighting
\usepackage{lmodern} % Ensures we have the right font
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsmath, amsthm, amssymb}
\usepackage[table, xcdraw]{xcolor}
\date{}
\title{Resultados}
\hypersetup{
 pdfauthor={Oriol Julián},
 pdftitle={Resultados},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 28.2 (Org mode 9.5.5)}, 
 pdflang={Spanish}}
\begin{document}

\maketitle
\tableofcontents


\section{Notación}
\label{sec:org59ce790}
\textbf{fun} = Mínimo local hallado de la función \emph{execute\textunderscore circuit} con el optimizador
\newline
\textbf{p} = Número de capas (a mayor número el circuito es más profundo)
\newline
\textbf{theta} = Lista de parámetros [\(\beta\)\textsubscript{1}, \ldots{}, \(\beta\)\textsubscript{p}, \(\gamma\)\textsubscript{1}, \ldots{}, \(\gamma\)\textsubscript{p}] del circuito cuántico
\newline
\textbf{num iterations} = Número de iteraciones del compilador necesarias para hallar el mínimo
\newline
\textbf{seed\textunderscore simulator} = Semilla utilizada en la ejecución del circuito para fijar la aleatoriedad en \emph{backend.run()}
\newline
\textbf{X\textsubscript{ij}} = Se refiere a la arista \textbf{i} -> \textbf{j}. 1 Si dicha arista es parte del camino resultante, 0 en otro caso
\newline
\textbf{q\textsubscript{n}} = Qubit enésimo
\newline
q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01}
\newpage

\section{Primer grafo}
\label{sec:orgea5ea3f}
\begin{center}
\includegraphics[width=.9\linewidth]{./img/primer_grafo.png}
\end{center}
\newpage
\subsection{Aer - Versión del paper (primer\textunderscore grafo/aer-qaoa.ipynb)}
\label{sec:org4e2d776}
Pruebas realizadas sobre la versión del código sin la restricción\newline
    \textbf{X\textsubscript{13} + X\textsubscript{23} = 1}\newline

Versión equivalente a la de [\href{https://www.mdpi.com/1424-8220/22/19/7570/xml}{Multi-Objective Routing Optimization for 6G Communication Networks Using a Quantum Approximate Optimization Algorithm-sensors-22-07570-v2}]

\begin{itemize}
\item \textbf{Estadísticas:}

Realizando la ejecución 1000 veces se han obtenido como caminos resultantes los siguientes:

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia} (1000)\\
\hline
10101 & X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} & 917\\
10110 & X\textsubscript{02}X\textsubscript{12}X\textsubscript{23} & 82\\
01001 & X\textsubscript{01}X\textsubscript{13} & 1\\
\hline
\end{tabular}
\end{center}
\end{itemize}
\newpage

\subsubsection{Caso correcto}
\label{sec:orgf43e8e6}

\begin{center}
\begin{tabular}{|r|l|r|r|}
\hline
\textbf{fun} & \textbf{theta} & \textbf{num iterations} & \textbf{seed\textunderscore simulator}\\
\hline
29.63 & [0.7739, 0.9302] & 29 & 10\\
\hline
\end{tabular}
\end{center}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.5]{./img/primer_paper_aer_correcto.png}
\caption{seed\textunderscore simulator=10}
\end{figure}

Mejor resultado: 10101 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} (Camino óptimo)

\newpage

\subsubsection{Caso erróneo}
\label{sec:orge2bd810}

\begin{center}
\begin{tabular}{|r|l|r|r|}
\hline
\textbf{fun} & \textbf{theta} & \textbf{num iterations} & \textbf{seed\textunderscore simulator}\\
\hline
52.79 & [0.6320  0.7177] & 35 & 21\\
\hline
\end{tabular}
\end{center}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.5]{./img/primer_paper_aer_erroneo.png}
\caption{seed\textunderscore simulator=21}
\end{figure}

Mejor resultado: 10110 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{02}X\textsubscript{12}X\textsubscript{23} (Camino incorrecto. Rompe 2 restricciones)

Restricciones rotas: \newline
    \textbf{X\textsubscript{02}+X\textsubscript{12}=X\textsubscript{23}} \newline
    \textbf{X\textsubscript{01}=X\textsubscript{12}+X\textsubscript{13}} \newline

\newpage

\subsubsection{Caso subóptimo}
\label{sec:org21c8d3c}

Obtenido a mano (no se ha encontrado ninguna semilla que diese este resultado)

\begin{center}
\begin{tabular}{|r|l|}
\hline
\textbf{fun} & \textbf{theta}\\
\hline
67.33 & [-0.4811, 1.566]\\
\hline
\end{tabular}
\end{center}

\begin{center}
\includegraphics[scale=0.5]{./img/primer_paper_aer_suboptimo.png}
\end{center}

Mejor resultado: 01001 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{01}X\textsubscript{13} (Camino subóptimo, pero no se rompe ninguna restricción)

\newpage

\subsubsection{Utilizando el parámetro \textbf{theta} obtenido en el artículo}
\label{sec:org9cfc0ff}

\begin{center}
\begin{tabular}{|r|l|}
\hline
\textbf{fun} & \textbf{theta}\\
\hline
65.40 & [0.28517317, -5.05969577]\\
\hline
\end{tabular}
\end{center}

\begin{center}
\includegraphics[scale=0.5]{./img/primer_paper_aer_resultado.png}
\end{center}

Mejor resultado: 10101 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} (Camino óptimo)

La gráfica resultante es muy similar a la versión que se intenta replicar. \textbf{fun} tiene resultados muy altos, entre 65 y 70 (en comparación con la versión del código con la restricción extra).

\newpage

\subsubsection{Rz(*2), Rzz(*2), Rx(*2)}
\label{sec:orga0198ff}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(coef * 2, q_idx)
circuit.rzz(coef * gamma[p] * 2, q_idxs[0], q_idxs[1])
circuit.rx(beta[p] * 4, q_idx)
\end{lstlisting}

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
11010 & X\textsubscript{02}X\textsubscript{13}X\textsubscript{23} & 845\\
11001 &  & 88\\
01010 &  & 5\\
11011 &  & 14\\
00101 &  & 21\\
00010 &  & 1\\
10110 &  & 14\\
10101 &  & 3\\
01001 &  & 5\\
10010 &  & 2\\
00110 &  & 2\\
\hline
\end{tabular}
\end{center}

\subsubsection{coef *= 2}
\label{sec:orgd2f0e9c}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(2 * coef, q_idx)
circuit.rzz(2 * coef * gamma[p], q_idxs[0], q_idxs[1])
circuit.rx(beta[p] * 2, q_idx)
\end{lstlisting}

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
11010 & X\textsubscript{02}X\textsubscript{13}X\textsubscript{23} & 966\\
11101 &  & 2\\
00101 &  & 18\\
01010 &  & 8\\
11001 &  & 3\\
00110 &  & 1\\
10110 &  & 2\\
\hline
\end{tabular}
\end{center}

Da un mismo error un porcentaje de veces muy alto. Error muy fiable.

\subsubsection{Coef /= 2}
\label{sec:org3b28255}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(1/2 * coef, q_idx)
circuit.rzz(1/2 * coef * gamma[p], q_idxs[0], q_idxs[1])
circuit.rx(beta[p] * 2, q_idx)
\end{lstlisting}

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
00000 &  & 1000\\
\hline
\end{tabular}
\end{center}

\newpage

\subsubsection{\(\beta\) /= 2}
\label{sec:orgba8b678}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(coef, q_idx)
circuit.rzz(coef * gamma[p], q_idxs[0], q_idxs[1])
circuit.rx(beta[p], q_idx)
\end{lstlisting}

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 & \uline{Óptimo} & 986\\
10110 &  & 14\\
\hline
\end{tabular}
\end{center}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.5]{./img/primer_paper_aer_beta-div-2.png}
\caption{Mejor resultado}
\end{figure}

\newpage

\subsubsection{\(\gamma\) /= 2}
\label{sec:orgb50fecd}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(coef, q_idx)
circuit.rzz(coef * gamma[p] / 2, q_idxs[0], q_idxs[1])
circuit.rx(beta[p] * 2, q_idx)
\end{lstlisting}

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 & \uline{Óptimo} & 1000\\
\hline
\end{tabular}
\end{center}

\newpage

\subsubsection{\(\beta\) /= 2, \(\gamma\) /= 2}
\label{sec:org2f767cd}
\lstset{language=Python,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
circuit.rz(coef, q_idx)
circuit.rzz(coef * gamma[p] / 2, q_idxs[0], q_idxs[1])
circuit.rx(beta[p], q_idx)
\end{lstlisting}


\begin{itemize}
\item num layers = 1:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 & \uline{Óptimo} & 1000\\
\hline
\end{tabular}
\end{center}

\item num layers = 2:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 960\\
10001 &  & 28\\
11001 &  & 12\\
\hline
\end{tabular}
\end{center}

\item num layers = 3:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 565\\
10001 &  & 111\\
11101 &  & 87\\
\ldots{} &  & \ldots{}\\
\hline
\end{tabular}
\end{center}
\end{itemize}

\newpage

\subsubsection{\(\beta\)\textsubscript{0} = 0.5, \(\gamma\)\textsubscript{0} = 0.5}
\label{sec:orgf304881}

\begin{itemize}
\item num layers = 1:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 1000\\
\hline
\end{tabular}
\end{center}

\item num layers = 2:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 992\\
11001 &  & 8\\
\hline
\end{tabular}
\end{center}

\item num layers = 3:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 469\\
11101 &  & 198\\
11011 &  & 88\\
\ldots{} &  & \ldots{}\\
\hline
\end{tabular}
\end{center}
\end{itemize}

\newpage

\subsubsection{Original pero variar num layers}
\label{sec:orgdd27800}

Al aumentar el número de capas se obtienen resultados mucho peores (tal vez esté mal implementado)
\begin{itemize}
\item num layers = 1: (Igual que tabla de estadisticas normal)
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 913\\
10110 &  & 86\\
01001 &  & 1\\
\hline
\end{tabular}
\end{center}

\item num layers = 2:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 646\\
10010 &  & 75\\
10110 &  & 70\\
10001 &  & 49\\
\ldots{} &  & \ldots{}\\
\hline
\end{tabular}
\end{center}

\item num layers = 3:
\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 &  & 634\\
10010 &  & 92\\
10001 &  & 84\\
01001 &  & 66\\
00000 &  & 36\\
\hline
\end{tabular}
\end{center}
\end{itemize}

\subsection{Aer simulator con restricción extra  (primer\textunderscore grafo/con\textunderscore restricc/aer-qaoa.ipynb)}
\label{sec:org0247eae}
Con respecto a la función de coste del paper se añade la restricción\newline
    \textbf{X\textsubscript{13} + X\textsubscript{23} = 1}\newline
Esto sería, que el camino solo llegue al nodo final \textbf{3} por una de las aristas X\textsubscript{i3} existentes.

\begin{itemize}
\item \textbf{Estadísticas:}
\end{itemize}

Realizando la ejecución 1000 veces se han obtenido como caminos resultantes los siguientes:

\begin{center}
\begin{tabular}{|r|l|r|}
\hline
\textbf{Qubits} & \textbf{Camino} & \textbf{Frecuencia (1000)}\\
\hline
10101 & X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} & 938\\
11000 & X\textsubscript{13}X\textsubscript{23} & 37\\
10001 & X\textsubscript{01}X\textsubscript{23} & 9\\
00011 & X\textsubscript{01}X\textsubscript{02} & 11\\
00100 & X\textsubscript{12} & 3\\
00010 & X\textsubscript{02} & 1\\
11111 & X\textsubscript{01}X\textsubscript{02}X\textsubscript{12}X\textsubscript{13}X\textsubscript{23} & 1\\
\hline
\end{tabular}
\end{center}

\newpage

\subsubsection{Caso correcto}
\label{sec:orge17fb47}
\begin{center}
\begin{tabular}{|r|l|r|r|}
\hline
\textbf{fun} & \textbf{theta} & \textbf{num iterations} & \textbf{seed\textunderscore simulator}\\
\hline
42.29 & [0.5081, 0.9401] & 33 & 3\\
\hline
\end{tabular}
\end{center}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.5]{./img/primer_restr_aer_correcto.png}
\caption{seed\textunderscore simulator=3}
\end{figure}

Mejor resultado: 10101 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} (Camino óptimo)

\newpage

\subsubsection{Caso "correcto" con ruido}
\label{sec:orgb7e9047}
\begin{center}
\begin{tabular}{|r|l|r|r|}
\hline
\textbf{fun} & \textbf{theta} & \textbf{num iterations} & \textbf{seed\textunderscore simulator}\\
\hline
90.75 & [0.9962, 1.995] & 27 & 2\\
\hline
\end{tabular}
\end{center}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.5]{./img/primer_restr_aer_correcto-con-ruido.png}
\caption{seed\textunderscore simulator=2}
\end{figure}

Mejor resultado: 10101 (q\textsubscript{4}q\textsubscript{3}q\textsubscript{2}q\textsubscript{1}q\textsubscript{0} = X\textsubscript{23}X\textsubscript{13}X\textsubscript{12}X\textsubscript{02}X\textsubscript{01})

Camino: X\textsubscript{01}X\textsubscript{12}X\textsubscript{23} (Camino óptimo)

Aunque se obtenga el resultado óptimo (10101) existen otros resultados demasiado altos, e incluso ejecutando el circuito con el mismo \textbf{theta} se dan valores distintos. Podría afectar a los resultados de las estadísticas.

Además se ve que encuentra un valor \textbf{fun} demasiado alto (90.75)

\newpage

\subsection{Provider}
\label{sec:org83afeb5}
\begin{itemize}
\item ibmq\textunderscore lima
\end{itemize}
\begin{figure}[htbp]
\centering
\includegraphics[scale=0.4]{./img/primer_provider_iter-2.png}
\caption{num iterations=2}
\end{figure}
Solo para comprobar que funciona la ejecución.
\end{document}